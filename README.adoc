= 2019 Kringlecon ctf writeup
Brandon Ingalls <brandon@tr4.dev>
v0.1.0, 2019-12-28
:toc:
:imagesdir: ./images
:stylesheet: ./css/dark.css

== Challenges

=== __ - Start of Kringlecon

Location: `Train Station`

Difficulty: `0/5`

image::99/00-Hello.png[My character next to santa]

* After signing in for the first time you find yourself at the `Train Station`
* Talk to `Santa`
* Get story
+
----
(Santa)
- Welcome to the North Pole and KringleCon 2!
- Last year, KringleCon hosted over 17,500 attendees and my castle got a little crowded.
- We moved the event to Elf University (Elf U for short), the North Pole’s largest venue.
- Please feel free to explore, watch talks, and enjoy the con!
----

=== 00 - Talk to Santa in the Quad

Location: `The Quad`

Difficulty: `0/5`

image::main/00/00-location.png[Me next to Santa]

.Objective
----
Enter the campus quad and talk to Santa.
----

==== Solution

. Click on `Santa` until they repeat

==== Chat

.Chat log
----
(Santa)
- This is a little embarrassing, but I need your help.
- Our KringleCon turtle dove mascots are missing!
- They probably just wandered off.
- Can you please help find them?
- To help you search for them and get acquainted with KringleCon, I’ve created some objectives for you. You can see them in your badge.
- Where's your badge? Oh! It's that big, circle emblem on your chest - give it a tap!
- We made them in two flavors - one for our new guests, and one for those who've attended both KringleCons.
- After you find the Turtle Doves and complete objectives 2-5, please come back and let me know.
- Not sure where to start? Try hopping around campus and talking to some elves.
- If you help my elves with some quicker problems, they'll probably remember clues for the objectives.
----

=== 01 - Find the Turtle Doves

Location: `Student Union`

Difficulty: `0/5`

image::main/01/00-location.png[Me next to the doves]

.Objective
----
Find the missing turtle doves.
----

==== Solution

. Click on the doves until they repeat

==== Chat

.Chat log
----
(Michael and Jane - Two Turtle Doves)
- Hoot Hooot?
----

=== 02 - Unredact Threatening Document

Location: `The Quad`

Difficulty: `1/5`

image::main/02/00-location.png[Me next to the redacted document]

.Objective
----
Someone sent a threatening letter to Elf University. What is the first word in ALL CAPS in the subject line of the letter? Please find the letter in the Quad.
----

==== Links

. link:files/main/02/LetterToElfUPersonnel.pdf[LetterToElfUPersonnel.pdf]
** The redacted document
+
NOTE: SHA256 `2f7b3ba81f1718d29ee73e82b19eb0f7a85e5b7835aaac0155edd233619b3c5e`

==== Solution

. Open the PDF
+
image::main/02/01-document.png[Picture of redacted document]
+
. Select all text in the document
+
NOTE: Using `[Ctrl]` + `a`
+
image::main/02/02-selected.png[Picture of highlighted document]
+
. Copy the text
+
NOTE: Using `[Ctrl]` + `c`
+
. Paste the copied content into a text editor
+
NOTE: Using `[Ctrl]` + `v`
+
.Documents unredacted contents
----
Date: February 28, 2019

To the Administration, Faculty, and Staff of Elf University
17 Christmas Tree Lane
North Pole

From: A Concerned and Aggrieved Character

Subject: DEMAND: Spread Holiday Cheer to Other Holidays and Mythical Characters… OR
ELSE!


Attention All Elf University Personnel,

It remains a constant source of frustration that Elf University and the entire operation at the
North Pole focuses exclusively on Mr. S. Claus and his year-end holiday spree. We URGE
you to consider lending your considerable resources and expertise in providing merriment,
cheer, toys, candy, and much more to other holidays year-round, as well as to other mythical
characters.

For centuries, we have expressed our frustration at your lack of willingness to spread your
cheer beyond the inaptly-called “Holiday Season.” There are many other perfectly fine
holidays and mythical characters that need your direct support year-round.

If you do not accede to our demands, we will be forced to take matters into our own hands.
We do not make this threat lightly. You have less than six months to act demonstrably.

Sincerely,

--A Concerned and Aggrieved Character

Confidential
Confidential
----

`First word in ALL CAPS` = `DEMAND`

== Side challenges

=== Escaping ED

Location: `Train Station`

image::side/00-escape-ed/00-location.png[Picture of challenge location]

The goal of this challenge is to find a way to escape from https://www.gnu.org/software/ed/manual/ed_manual.html[ed].

.Initial
----
                  ........................................
               .;oooooooooooool;,,,,,,,,:loooooooooooooll:
             .:oooooooooooooc;,,,,,,,,:ooooooooooooollooo:
           .';;;;;;;;;;;;;;,''''''''';;;;;;;;;;;;;,;ooooo:
         .''''''''''''''''''''''''''''''''''''''''';ooooo:
       ;oooooooooooool;''''''',:loooooooooooolc;',,;ooooo:
    .:oooooooooooooc;',,,,,,,:ooooooooooooolccoc,,,;ooooo:
  .cooooooooooooo:,''''''',:ooooooooooooolcloooc,,,;ooooo,
  coooooooooooooo,,,,,,,,,;ooooooooooooooloooooc,,,;ooo,
  coooooooooooooo,,,,,,,,,;ooooooooooooooloooooc,,,;l'
  coooooooooooooo,,,,,,,,,;ooooooooooooooloooooc,,..
  coooooooooooooo,,,,,,,,,;ooooooooooooooloooooc.
  coooooooooooooo,,,,,,,,,;ooooooooooooooloooo:.
  coooooooooooooo,,,,,,,,,;ooooooooooooooloo;
  :llllllllllllll,'''''''';llllllllllllllc,



Oh, many UNIX tools grow old, but this one's showing gray.
That Pepper LOLs and rolls her eyes, sends mocking looks my way.
I need to exit, run - get out! - and celebrate the yule.
Your challenge is to help this elf escape this blasted tool.

-Bushy Evergreen

Exit ed.

1100
----

==== Solution

. Press `Q` then the `[enter]` key
+
image::side/00-escape-ed/01-solution.png[Picture of the solution dialog]

==== Chat

----
(Bushy Evergreen - PRE)
- Hi, I'm Bushy Evergreen. Welcome to Elf U!
- I'm glad you're here. I'm the target of a terrible trick.
- Pepper Minstix is at it again, sticking me in a text editor.
- Pepper is forcing me to learn ed.
- Even the hint is ugly. Why can't I just use Gedit?
- Please help me just quit the grinchy thing.

(Bushy Evergreen - POST)
-Wow, that was much easier than I'd thought.
-Maybe I don't need a clunky GUI after all!
-Have you taken a look at the password spray attack artifacts?
-I'll bet that DeepBlueCLI tool is helpful.
-You can check it out on GitHub.
-It was written by that Eric Conrad.
-He lives in Maine - not too far from here!
----
